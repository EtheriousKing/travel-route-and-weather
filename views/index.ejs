<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tour Weather</title>
    <link rel="stylesheet" href="/styles/main.css">
    <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?key=AkWs--1irsbac3yla7MAIGG58ZZ5pN_XS7CZFPgz-EUa5Wv3CX2uuHYVAOI8_DF_&callback=loadMapScenario' async defer></script>
</head>
<body>
    <section id="inputs">
        <h2>To retrieve the route, and weather information for both your starting location and your destination, kindly fill the form provided below: </h2>
        <form action="/getTravelWeather" method="post">
            <label for="currentLocation">Enter your starting location: </label>
            <input name="currentLocation" type="text" placeholder="Starting Location">
            <label for="destination">Enter your destination: </label>
            <input name= "destination" type="text" placeholder="Destination">
            <input class="submitButton" type="submit" value="Submit"> 
        </form>
        <h2>To obtain the weather information for a specific location, kindly fill the form below: </h2>
        <form action="/getWeather" method="post">
            <label for="location">Please enter your desired location: </label>
            <input name="location" type="text" placeholder="Miami,Florida">
            <input class="submitButton" type="submit" value="Submit">
        </form>
    </section>
    <% if (locals.weather) { %>
     <section id="weather">
        <h3>Weather</h3>
        <ul>
            <li><img src="<%= weather.current.condition.icon %>" alt=""><%=weather.current.condition.text  %></li>
        </ul>
        <p>City: <%= weather.location.name %></p>
        <p>Region: <%= weather.location.region %></p>
        <p>Country: <%= weather.location.country %></p>
        <p>Timezone: <%= weather.location["tz_id"] %></p>
        <p>Temperature: <%=weather.current["temp_c"]%>°C / <%=weather.current["temp_f"] %>°F</p>
        <p>Humidity: <%= weather.current.humidity %></p>
        <p>UV: <%= weather.current.uv %></p>
        <p>Wind Speed: <%= weather.current["wind_kph"] %> kph / <%= weather.current["wind_kph"] %> mph</p>
     </section>
    <% } %>  
    <% if (locals.map) { %>
     <section id="route">
        <img src="data:image/jpeg;base64,<%= map %>" />
        <div id="myMap"></div>
        <script>
        function loadMapScenario() {
            var map = new Microsoft.Maps.Map(document.getElementById('myMap'), {

            });
            Microsoft.Maps.loadModule('Microsoft.Maps.Directions', function () {
                var directionsManager = new Microsoft.Maps.Directions.DirectionsManager(map);
                // Set Route Mode to driving
                directionsManager.setRequestOptions({ routeMode: Microsoft.Maps.Directions.RouteMode.driving });
                var waypoint1 = new Microsoft.Maps.Directions.Waypoint({  location: new Microsoft.Maps.Location(location.actualStart.coordinates[0], location.actualStart.coordinates[1]) });
                var waypoint2 = new Microsoft.Maps.Directions.Waypoint({  location: new Microsoft.Maps.Location(location.actualEnd.coordinates[0], location.actualEnd.coordinates[1]) });
                directionsManager.addWaypoint(waypoint1);
                directionsManager.addWaypoint(waypoint2);
                // Set the element in which the itinerary will be rendered
                directionsManager.calculateDirections();
            });
            
        }</script>
     </section>
    <% } %>
    <section id="footer">
        <%- include("partials/footer.ejs") %>
    </section> 
</body>
</html>